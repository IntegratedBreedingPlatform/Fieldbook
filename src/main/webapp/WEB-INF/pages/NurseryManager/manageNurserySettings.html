<div class="col-xs-12 col-md-12" xmlns:th="http://www.thymeleaf.org">
	<div class="page-header">
		<h1 th:text="#{nursery.managesettings.manage.saved.nursery.settings}">
			MANAGE SAVED NURSERY SETTINGS
		</h1>
	</div>			  
</div>

<form id="saveAdvanceNurseryForm" role="form-horizontal" action="#" th:action="@{/NurseryManager/manageNurserySettings}" 
method="post" th:object="${manageSettingsForm}" enctype="multipart/form-data">
<div class="col-xs-12 col-md-12" xmlns:th="http://www.thymeleaf.org">
	<div class="row">
		<div class="col-xs-12 col-md-12">
			<div class="panel panel-default">
		    	<div class="panel-body">
		    		<div class="row form-group">
			    		<div class="col-xs-3 col-md-3">
			    			<label class="control-label"> <strong th:text="#{nursery.managesettings.choose.saved.settings}+':'"> Choose Saved Settings: </strong></label>
			    		</div>
			    		
			    		<div class="col-xs-3 col-md-3">
			    			<select th:field="*{selectedSettingId}" class="form-control">
			    				<option th:each="setting : ${settingsList}" th:value="${setting[id]}" th:text="${setting[name]}">Nursery Type 1</option>
			    			</select>
			    		</div>
			    		<div class="col-xs-2 col-md-2">
			    			<a href="" th:text="#{nursery.managesettings.make.copy}" >Make a Copy</a>
			    		</div>
			    		<div class="col-xs-2 col-md-2">
			    			<span class="glyphicon glyphicon-plus"></span>&nbsp;
			    			<a href="" th:text="#{nursery.managesettings.add.new.settings}">Add New Settings</a>
			    		</div>
			    		<div class="col-xs-2 col-md-2">
			    		</div>
		    		</div>
		    	</div>
	    	</div>		
		</div>
	</div>
	<div class="row">
		<div class="col-xs-12 col-md-12">
			<div class="panel panel-default">
		    	<div class="panel-body">
		    		<div class="row form-group">
			    		<div class="col-xs-12 col-md-12">
			    			<label class="control-label"><em th:text="#{nursery.managesettings.mandatory.fields}"> Mandatory fields are noted with a *</em></label>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
			    			<label class="control-label"><strong class="sub-content-heading" th:text="#{nursery.managesettings.nursery.level.details}">NURSERY-LEVEL DETAILS</strong></label>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
			    			<label class="control-label" th:text="#{nursery.managesettings.nursery.level.notes}"> The settings in this section apply across all plots in the nursery. 
			    			You can add settings at this level, or remove those that you wish to manage at the plot level.</label>
		    			</div>
	    			</div>
	    			<div class="row form-group" th:each="nurseryLevelVariable : *{nurseryLevelVariables}">
	    				<div class="col-xs-3 col-md-3">
	    					<span th:if="${nurseryLevelVariable.isDelete}" class="glyphicon glyphicon-remove-sign"></span> &nbsp;&nbsp;
	    					<label class="control-label" th:text="${nurseryLevelVariable.variable.name}"></label> 
	    				</div>
	    				<div class="col-xs-9 col-md-9">
	    					<select th:field="${nurseryLevelVariable.value}" class="form-control">
	    						<option th:each="possibleValue : ${nurseryLevelVariable.possibleValue}" th:value="${possibleValue.id}" th:text="${possibleValue.name}"> </option>
    						</select>
	    				</div>
	    			</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					<span class="glyphicon glyphicon-plus"></span>&nbsp;
			    			<a href="javascript: openAddVariablesSetting(1);" th:text="#{nursery.managesettings.add.nursery.level.settings}">Add Nursery-Level Settings</a>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
			    			<label class="control-label"><strong class="sub-content-heading" th:text="#{nursery.managesettings.plot.level.details}">PLOT-LEVEL DETAILS</strong></label>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
			    			<label class="control-label" th:text="#{nursery.managesettings.plot.level.notes}"> Select the settings you will record at the plot level in the nursery. 
			    			These will appear as data columns in your nursery book. You can add and remove settings at this level.</label>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-6 col-md-6">
	    					<table class="my-class table table-curved table-condensed">
	    						<thead>
								<tr>
									<th></th>
					                <th th:utext="#{nursery.managesettings.plot.name}">.Name</th>
					                <th th:utext="#{nursery.managesettings.plot.description}">.Description</th>
								</tr>
								</thead>
								<tbody>
			    					<tr th:each="plotLevelVariable : *{plotLevelVariables}">
			    					<td> <span th:if="${plotLevelVariable.isDelete}" class="glyphicon glyphicon-remove-sign"></span> </td>
			    					<td th:text="${plotLevelVariable.variable.name}"></td>
			    					<td th:text="${plotLevelVariable.variable.description}"></td>
			    					</tr> 
		    					</tbody>
	    					</table>
	    				</div>
	    				<div class="col-xs-6 col-md-6"></div>
	    			</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					<span class="glyphicon glyphicon-plus"></span>&nbsp;
			    			<a href="javascript: openAddVariablesSetting(2);" th:text="#{nursery.managesettings.add.plot.level.settings}">Add Plot-Level Settings</a>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
			    			<label class="control-label"><strong class="sub-content-heading" th:text="#{nursery.managesettings.baseline.traits}">BASELINE TRAITS</strong></label>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
			    			<label class="control-label" th:text="#{nursery.managesettings.baseline.traits.notes}"> The list below shows the standard traits available for Cowpea. 
			    			You can add and remove traits in this list to create the baseline set of traits you are working with in your program. 
			    			You will be able to add additional traits to measure in each nursery.</label>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-6 col-md-6">
	    					<table class="my-class table table-curved table-condensed">
	    						<thead>
								<tr>
									<th></th>
					                <th th:utext="#{nursery.managesettings.trait}">.Trait</th>
					                <th th:utext="#{nursery.managesettings.trait.description}">.Description</th>
								</tr>
								</thead>
								<tbody>
			    					<tr th:each="baselineTraitVariable : *{baselineTraitVariables}">
			    					<td> <span th:if="${baselineTraitVariable.isDelete}" class="glyphicon glyphicon-remove-sign"></span> </td>
			    					<td th:text="${baselineTraitVariable.variable.name}"></td>
			    					<td th:text="${baselineTraitVariable.variable.description}"></td>
			    					</tr> 
		    					</tbody>
	    					</table>
	    				</div>
	    				<div class="col-xs-6 col-md-6"></div>
	    			</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					<span class="glyphicon glyphicon-plus"></span>&nbsp;
			    			<a href="javascript: openAddVariablesSetting(3);" th:text="#{nursery.managesettings.add.baseline.traits}">Add Baseline Traits</a>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
    				<!--  
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
			    			<label class="control-label"><strong class="sub-content-heading" th:text="#{nursery.managesettings.field.layout}">FIELD LAYOUT</strong></label>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-3 col-md-3">
	    					<label class="contol-label">Select Field Layout for Nursery:*</label>
	    				</div>
	    				<div class="col-xs-4 col-md-4">
	    					<select>
	    						<option>Unreplicated Design With Randomization</option>
	    					</select>
	    				</div>
	    				<div class="col-xs-5 col-md-5">
	    					<a href="">Manage Field Layouts</a>
	    				</div>
    				</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
    				<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
			    			<label class="control-label"><strong class="sub-content-heading">ADDITIONAL OPTIONS</strong></label>
		    			</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-10 col-md-10">
	    					<label class="control-label"> Will you make additional observations a about the nursery conditions during the growing season (e.g. rainfall)?: *</label>
	    				</div>
	    				<div class="col-xs-2 col-md-2">
	    					<label class="radio-inline">
							  <input checked="checked" type="radio" value="1" name="additionalObservations" id="additionalObservations" /> 
							  <span>Yes</span>
							</label>
							<label class="radio-inline">
							  <input type="radio" value="0" name="additionalObservations" id="additionalObservations"/> 
							  <span>No</span>
							</label>
	    				</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
    				-->
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					<label class="control-label"><strong class="sub-content-heading" th:text="#{nursery.managesettings.save.settings}">SAVE SETTINGS</strong></label>
	    				</div>
    				</div>
    				<div class="row form-group">
	    				<div class="col-xs-5 col-md-5">
	    					<label class="contol-label" th:text="#{nursery.managesettings.save.settings.as}+':'">Save these settings as:</label>
	    					&nbsp;&nbsp;
	    					<input type="text" th:field="*{settingName}" />
	    				</div>
	    				<div class="col-xs-7 col-md-7">
	    					<input type="checkbox" th:field="*{isDefault}" /> 
	    					<label class="control-label" th:text="#{nursery.managesettings.set.default}"> Set as default for this program (overrides previous defaults)</label>
	    				</div>
	    			</div>
	    			<div class="row form-group">
	    				<div class="col-xs-12 col-md-12">
	    					&nbsp;
	    				</div>
    				</div>
	    			<div class="row form-group">
	    				<div class="col-xs-5 col-md-5">
	    				</div>
	    				<div class="col-xs-2 col-md-2">
	    					<input type="button" onclick="javascript: window.history.back();"  value="Cancel" th:value="#{common.form.cancel.text}" class="btn btn-default"/>
	    					<input type="button" value="Save" th:value="#{common.form.save.text}" class="btn btn-primary" />
	    				</div>
	    				<div class="col-xs-5 col-md-5">
	    				</div>
    				</div>
		    	</div>
	    	</div>	
		</div>
	</div>
	<div class="row">
		<div class="col-xs-12 col-md-12">
			<div th:include="/NurseryManager/addVariablesSettingModal"></div>
		</div>
	</div>
</div>
</form>
<div layout:fragment="page-script">
<script type='text/javascript' th:inline="javascript">
	//<![CDATA[   
 			$( document ).ready(function() {
 				$('#selectedSettingId').on('change', function(){
 					alert('load settings' + $(this).val());
 					
 				})
 			});       
 			
 			function openAddVariablesSetting(variableType) {
 				getStandardVariables(variableType);
 				$("#addVariablesSettingModal").modal("show"); 				
 			}
 			
 			function getStandardVariables(variableType) {
 				Spinner.toggle();
 				$.ajax({
 					url: "/Fieldbook/NurseryManager/manageNurserySettings/displayAddSetting/" + variableType,
 					type: "GET",
 					cache: false,
 					success: function (data) {
 						initializeStandardVariableSearch(data);
 					},
 					error: function(jqXHR, textStatus, errorThrown){
 						console.log("The following error occured: " + textStatus, errorThrown); 
 					},
 					complete: function() {
 						Spinner.toggle();
 					}
 				});
 			}
 			
 			function initializeStandardVariableSearch(data) {
 				var searchTypeAhead = $("#srch-var").typeahead({
 	        		   	  name: "StandardVariableSearch", 
 	        		   	  local: $.parseJSON(data),
 	        		   	  limit : 20,   	
 	        		   	  template: "<p>{{id}} - {{name}}</p>",
 	        		   	  engine: Hogan 	        		   	
        		   	});
 				
       		   	searchTypeAhead.on("typeahead:selected",function(evt,data){
       		   	    getStandardVariableDetails(data.id);
       		   	    return false;
       		   	    });
       		   	searchTypeAhead.on("typeahead:autocomplete",function(evt,data){
       		   		getStandardVariableDetails(data.id);
       		   	    return false;
       		   	    });
 			}
 			
 			function getStandardVariableDetails(id) {
 				Spinner.toggle();
 				$.ajax({
 					url: "/Fieldbook/NurseryManager/manageNurserySettings/showVariableDetails/" + id,
 					type: "GET",
 					cache: false,
 					success: function (data) {
 						populateAttributeFields($.parseJSON(data));
 					},
 					error: function(jqXHR, textStatus, errorThrown){
 						console.log("The following error occured: " + textStatus, errorThrown); 
 					},
 					complete: function() {
 						Spinner.toggle();
 					}
 				});
 			}
 					
 			function populateAttributeFields(data) {
 				$("#selectedTraitClass").text(data.traitClass);
 				$("#selectedProperty").text(data.property);
 				$("#selectedMethod").text(data.method);
 				$("#selectedScale").text(data.scale);
 				$("#selectedDataType").text(data.dataType);
 				$("#selectedRole").text(data.role);
 				$("#selectedCropOntologyId").text(data.cropOntologyId);
 				$("#selectedStdVarId").val(data.cvTermId);
 				$("#selectedName").val(data.name);
 			}
	
      //]]>
    </script>
	
</div>