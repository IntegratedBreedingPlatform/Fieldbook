<div class="col-xs-12 col-md-12" xmlns:th="http://www.thymeleaf.org">
	<div class="page-header">
		<h1 th:text="#{nursery.managenurseries.header}">
			Manage Nurseries
		</h1>
	</div>	
	</div>
	<div class="move-left col-xs-12 col-md-12">
		<div class="form-group">
		
			<div id="page-message" class="">
			</div>				
			
		</div>
	
	<div>

	<div class="row">
		<div class="col-xs-7 col-md-7">	
			<img th:src="@{/static/img/new-nursery.png}" class="image-padding image-padding-with-text"  /> 
			<label class="h2_no_transform" th:text="#{browse.nurseries.header}"></label>
			<label class="control-label"><a href="javascript: openStudyTree(1)">Browse</a> for a nursery to work with.</label>
		</div>
		<div class="col-xs-5 col-md-5">
			<div style="float: right;padding-right: 10px;">
				<a href="" th:href="@{/NurseryManager/createNursery}" class="btn btn-info" th:utext="#{browse.nursery.start.new.nursery}">+ Start a New Nursery</a>				
			</div>
		</div>
	</div>	
	
	<div class="row">
	&nbsp;
	</div>
		
		<!-- details section -->
	<div class="row">	
		<div id="browser-nurseries">
			<div class="col-xs-12 col-md-12">
			    <div th:include="/NurseryManager/ver2.0/studyInfo"/>	
			</div>
		</div>
	</div>
		
	</div>
</div>

<div class="row">				
	<div th:include="/NurseryManager/ver2.0/studyTree"/>
</div>

<div class="row">
	<div class="col-xs-12 col-md-12">
		<div id="showBaselineTraitDetails" th:include="/NurseryManager/baselineTraitDetails"></div>
	</div>
</div>

<div class="row">
	<div id="ontology-add-variable" th:include="/Fieldmap/selectTrialInstanceModal"></div>
</div>

    <div class="modal fade" id="manageTrialConfirmation" tabindex="-1" role="dialog" aria-labelledby="manageTrialConfirmationLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title">Confirmation</h4>
          </div>
          <div class="modal-body">
			<div class="row">
				<div class="col-xs-offset-1 col-xs-11 col-md-offset-1 col-md-11">
					<p th:text="#{fieldmap.confirmation.for.viewing.generated.fieldmap}">Do you wish to view the generated fieldmap(s)?</p>
				</div>
			</div>
			<br/>
			<div class="row">
				<div class="col-xs-offset-5 col-xs-7 col-md-offset-5 col-md-7">
					<div class="form-group">
						<input type="hidden" id="fieldmapStudyId" name="fieldmapStudyId" />
						<input type="hidden" id="fieldmapDatasetId" name="fieldmapDatasetId" />
						<input type="hidden" id="fieldmapGeolocationId" name="fieldmapGeolocationId" />
						<button type="button" class="btn btn-danger" th:value="#{common.form.yes.text}" onclick="javascript: proceedToCreateFieldMap();">No</button>			        	
						<button type="button" class="btn btn-primary" th:value="#{common.form.no.text}" onclick="javascript: proceedToGenerateFieldMap();">Yes</button>
					</div>
				</div>
			</div>			        	
          </div>
        </div>
      </div>
    </div>

<div layout:fragment="page-script">
	<!-- For pagination -->
	<script type='text/javascript' th:inline="javascript">
	//<![CDATA[    
        var createLabelErrorMsg = /*[[#{common.error.create.label.nursery}]]*/;
        var fieldMapStudyRequired = /*[[#{common.error.select.study(#{fieldmap.nursery})}]]*/;
        var fieldMapOneStudyErrorMsg = /*[[#{common.error.select.one.study.show.fieldmap(#{fieldmap.nursery})}]]*/;
        var noFieldMapExists = /*[[#{common.error.no.existing.fieldmap(#{fieldmap.nursery})}]]*/;
        var openStudyError = /*[[#{common.error.open.study(#{fieldmap.nursery})}]]*/;
        var advanceStudyError = /*[[#{common.error.advance.study(#{fieldmap.nursery})}]]*/;
     	var paginationUrl = /*[[@{/NurseryManager/manageNurseries/page/}]]*/;
     	var showText = /*[[#{nursery.nurserydetails.additional.show}]]*/;
     	var hideText = /*[[#{nursery.nurserydetails.additional.hide}]]*/;
        
        var selectedTableIds = new Array();
        
        
     	 $('#make-nursery').on('click', function(){
     		Spinner.toggle();
     		$.ajax(
   		         { url: $(this).val(),
   		           type: "GET",
   		           data: "",
   		        	cache: false,
   		           success: function(html) {
		        	   Spinner.toggle();
   		               
   		           }
   		         }
   		       );
     	}); 
     	

     	$(document).ready(function() {
     		$('.toggle-icon').click(function(){ 
     			var expandedImg = $(this).find(".section-expanded");
     			var collapsedImg = $(this).find(".section-collapsed");
     		   	expandedImg.toggle();
     		   	collapsedImg.toggle();
     		});

     		$("#open-study-url-link").click(function() {
     			selectedTableIds[0] = $("#studyId").val();
     		});

     		$("#advance-study-url-link").click(function() {
     			selectedTableIds[0] = $("#studyId").val();
     		});

     		$("#fieldmap-url-link").click(function() {
     			selectedTableIds[0] = $("#studyId").val();
     		});

     		$("#label-printing-url-link").click(function() {
     			selectedTableIds[0] = $("#studyId").val();
     		});

     		$("#view-fieldmap-url-link").click(function() {
     			selectedTableIds[0] = $("#studyId").val();
     		});
     		
     		$("#toggle-additional-link").click(function() {
     			if ($(this).text() == showText) {
     				$(this).text(hideText);
     			}
     			else {
     				$(this).text(showText);
     			}
     		});
     		
     		$(".dataset-toggle").click(function() {
     			loadDatasetDropdown($(this).parent().find("#dataset-selection"));
     		});
     		
     		$("#dataset-selection").change(function() {
     			if ($("#dataset-selection").val()) {
     				var id = $("#dataset-selection").val();
     				var name = $("#dataset-selection option:selected").text();
     				var found = false;
     				$("#measurement-tabs").children().hide();
     				$("#measurement-tab-headers").find("li").each(function(index) {
     					$(this).removeClass("active");
     					if ($(this).text() == name) {
     						$(this).addClass("active");
     						$("#dset-tab-" + id).show();
     						found = true;
     					}
     				});
     				if (!found) {
     					loadDatasetMeasurementRowsViewOnly(id, name);
     				}
     			}
     		});
     	});
        
      //]]>
    </script>
</div>