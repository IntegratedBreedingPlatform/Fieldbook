<div class="page-header">
	<h1>
		Step 3: Add or Remove Traits
	</h1>
	
	<div class="progress">
	  <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%;">
	    <span class="sr-only">75% Complete</span>
	  </div>
	</div>
</div>

	<div id="page-message"> 
	</div>

<div id="germplasm-measurement-list-table-div" th:include="/NurseryManager/showAddOrRemoveTraitsPagination">
    </div>
     
				
				
    		


<!-- 
<script type="text/javascript" th:src="@{/static/js/jquery.ba-throttle-debounce.min.js}"></script>
<script type="text/javascript" th:src="@{/static/js/jquery.stickyheader.js}"></script>
 -->
<script type='text/javascript' th:inline="javascript">
	//<![CDATA[
	           
	            
        
	           
		function doSave(){
			if(validateCells() == false)
				return false;
  	      	var $form = $("#addVariableForm");
  			serializedData = $form.serialize();
  			$("btnUpdate").attr("disabled", "disabled");
			Spinner.toggle();

			$.ajax({
				url: "/Fieldbook/NurseryManager/addOrRemoveTraits/updateTraits",
				type: "post",
				dataType: "json",
				data: serializedData,
			    success: function(data){
				    if (data.status == "1") {
				    	$('#successMessageModal').modal({ backdrop: 'static', keyboard: true }) 
				    	$("#successMessageModal").modal("show");
			       	} else if (data.status == "-1") {
			       		showErrorMessage('page-message', data.errorMessage);
			       	}
			   }, 
			   error: function(jqXHR, textStatus, errorThrown){
					console.log("The following error occured: " + textStatus, errorThrown); 
			   }, 
			   complete: function(){  
				   $("btnUpdate").removeAttr("disabled");
				   Spinner.toggle();
			   } 
			});
		}      
		
	
      
       
       function validateCells(){
    	   var noError = true;
    	   $('.germplasm-measurement-list-table td input').each(function(){
			   if($(this).data('type') == 'N'){
	    			  if(isNaN(Number($(this).val()))){    				   
	    				  showErrorMessage('page-message', "Please enter a numeric value for this variate");
	    				  var id = $(this).attr('id');
	    				  setTimeout(function() { $('#'+getJquerySafeId(id)).focus(); }, 10);
	    				  noError = false;
	    				  //console.log('false');
	    				  return false;
	    			  }
			   }
		   }); 
    	   if(noError){
    		   hideErrorMessage('page-message');
    	   }
    	   //console.log('true');
    	   return noError;
       }
       
      //]]>
    </script>
