<div class="list-details">
<div class="row">
			<div class="col-xs-6 col-md-6">
				<label class="control-label control-label-bold">List Name:</label>
			</div>
	<div class="col-xs-6 col-md-6">
		<label class="germplasm-header-details" id="list-name"></label>
	</div>	
</div>
<div class="row">
	<div class="col-xs-6 col-md-6">
		<label class="control-label control-label-bold">List Owner:</label>
	</div>
	<div class="col-xs-6 col-md-6">
		<label class="germplasm-header-details" id="list-owner"></label>
	</div>		
</div>
<div class="row">
	<div class="col-xs-6 col-md-6">
		<label class="control-label control-label-bold">Status:</label>
	</div>	
	<div class="col-xs-6 col-md-6">
		<label class="germplasm-header-details" id="list-status"></label>
	</div>	
</div>
<div class="row">
	<div class="col-xs-6 col-md-6">
		<label class="control-label control-label-bold">Description:</label>
	</div>	
	<div class="col-xs-6 col-md-6">
		<label class="germplasm-header-details" id="list-description"></label>
	</div>	
</div>
<div class="row">
	<div class="col-xs-6 col-md-6">
		<label class="control-label control-label-bold">Type:</label>
	</div>	
	<div class="col-xs-6 col-md-6">
		<label class="germplasm-header-details" id="list-type"></label>
	</div>	
</div>
<div class="row">
	<div class="col-xs-6 col-md-6">
		<label class="control-label control-label-bold">Date:</label>
	</div>	
	<div class="col-xs-6 col-md-6">
		<label class="germplasm-header-details" id="list-date"></label>
	</div>	
</div>
<div class="row">
	<div class="col-xs-6 col-md-6">
		<label class="control-label control-label-bold">Notes:</label>
	</div>	
	<div class="col-xs-6 col-md-6">
		<label class="germplasm-header-details" id="list-notes"></label>
	</div>	
</div>
</div>

<div layout:fragment="page-script">
<script type='text/javascript' th:inline="javascript">
	//<![CDATA[
		/*globals console, changeBrowseGermplasmButtonBehavior, chooseListNode, chooseList, showListTreeToolTip*/
		/*glboals getMessageErrorDiv, showErrorMessage, moveGermplasm*/
		/*exported displayGermplasmListTree, cannotMove,hasChildrenString,pleaseChooseFolder,openTreeType*/
		/*exported getDisplayedTreeName*/

			var cannotMove = /*[[#{browse.nursery.move.can.not}]]*/ '',
				hasChildrenString = /*[[#{browse.nursery.move.has.children}]]*/ '',
				pleaseChooseFolder = /*[[#{import.germplasm.choose.a.list}]]*/ '',
				lazyLoadUrl = '/Fieldbook/ListTreeManager/expandGermplasmTree/',
				additionalLazyLoadUrl = '',
				germplasmFocusNode = null,
				openTreeType = 0;						
			
			function getDisplayedTreeName(){
				'use strict';
				if($('#listTreeModal').hasClass('in') === true){
					return 'germplasmTree';
				}
				else if($('#saveListTreeModal').hasClass('in') === true){
					return 'germplasmFolderTree';
				}
			}
			function getMessageErrorDiv(){
				'use strict';
				 var msgDiv = 'page-import-message-modal';
				 if(getDisplayedTreeName() === 'germplasmFolderTree'){
				 	msgDiv = 'page-save-list-message-modal';
				 }					
				 return msgDiv;
			}

			function doGermplasmLazyLoad(node) {
				'use strict';
				
				if (node.data.isFolder === true){
					Spinner.play();
					node.appendAjax({
						url: lazyLoadUrl + node.data.key + additionalLazyLoadUrl,
						dataType: 'json',
						success: function(node) {
							//do nothing
							Spinner.stop();
							setTimeout(function(){node.focus();}, 50);
							if(node.hasChildren()) {
								$('.delete-germplasm-folder').addClass('disable-image');
							}

							if(node.data.isFolder === false) {
								changeBrowseGermplasmButtonBehavior(false);
							}else{
								if(node.data.key > 1 || node.data.key === 'CENTRAL'){
									changeBrowseGermplasmButtonBehavior(false);
								}else if(node.data.key === 'LOCAL') {
									changeBrowseGermplasmButtonBehavior(true);
									$('.edit-germplasm-folder').addClass('disable-image');
									$('.delete-germplasm-folder').addClass('disable-image');
								}
								else {
									changeBrowseGermplasmButtonBehavior(true);
								}
							}
						},
						error: function(node, XMLHttpRequest, textStatus, errorThrown) {
							Spinner.stop();
							console.log('The following error occured: ' + textStatus, errorThrown);
						},
						cache: false
					});
					node.expand();
				}
			}
			
			/** Germplasm Tree **/
			function displayGermplasmListTree(treeName, isLocalOnly, isFolderOnly, clickFunction) {
				'use strict';
				var lazyLoadUrlGetChildren = '/Fieldbook/ListTreeManager/expandGermplasmTree/';
				var initLoadUrl = '/Fieldbook/ListTreeManager/loadInitGermplasmTree';

				if(isLocalOnly === true) {
					initLoadUrl = '/Fieldbook/ListTreeManager/loadInitGermplasmLocalTree';
				}

				
				initLoadUrl += '/' + isFolderOnly;

                var dynaTreeOptions = {
                    title: treeName,
                    checkbox: false,
                    noLink: false,
                    autoFocus: false,
                    imagePath: '/Fieldbook/static/img/',
                    activeVisible: true,
                    initAjax: {url: initLoadUrl,
                        dataType: 'json'
                    },
                    onLazyRead: function (node) {
                        doGermplasmLazyLoad(node);
                    },
                    onRender: function (node, nodeSpan) {
                        //console.log(node);
                        if (node.data.key !== 'LOCAL' && node.data.key !== 'CENTRAL' && node.data.key !== '_statusNode' && node.data.isFolder === false) {
                            showListTreeToolTip(node, nodeSpan);
                        }
                    },
                    classNames: {
                        container: 'fbtree-container',
                        expander: 'fbtree-expander',
                        nodeIcon: 'fbtree-icon',
                        combinedIconPrefix: 'fbtree-ico-',
                        focused: 'fbtree-focused',
                        active: 'fbtree-active',
                        nodeLoading: ''
                    },
                    onFocus: function (node) {
                        $('.popover').hide();
                        $(node.span).find('.dynatree-title').popover('show');
                        germplasmFocusNode = node;
                    },
                    onActivate: function (node) {

                        if (node.data.isFolder === false) {
                            changeBrowseGermplasmButtonBehavior(false);
                        } else {
                            if (node.data.key > 1 || node.data.key === 'CENTRAL') {
                                changeBrowseGermplasmButtonBehavior(false);
                            } else if (node.data.key === 'LOCAL') {
                                changeBrowseGermplasmButtonBehavior(true);
                                $('.edit-germplasm-folder').addClass('disable-image');
                                $('.delete-germplasm-folder').addClass('disable-image');
                            }
                            else {
                                changeBrowseGermplasmButtonBehavior(true);
                            }
                        }
                        $('.germplasm-tree-section a.dynatree-title').off('keyup');
                        $('.germplasm-tree-section a.dynatree-title').on('keyup', function (e) {
                            if (e.keyCode === 13) {
                                chooseListNode(germplasmFocusNode, true);
                            }
                        });
                    },
                    onDblClick: function (node, event) {
                        chooseList();
                    },
                    dnd: {
                        onDragStart: function (node) {
                            /** This function MUST be defined to enable dragging for the tree.
                             * Return false to cancel dragging of node.
                             */
                            if (node.data.key > 0) {
                                return false;
                            }
                            return true;
                        },
                        preventVoidMoves: true, // Prevent dropping nodes 'before self', etc.
                        onDragEnter: function (node, sourceNode) {
                            return true;
                        },
                        onDragOver: function (node, sourceNode, hitMode) {

                        },
                        onDrop: function (node, sourceNode, hitMode, ui, draggable) {
                            /** This function MUST be defined to enable dropping of items on
                             * the tree.
                             */
                            if (sourceNode.hasChildren()) {
                                showErrorMessage(getMessageErrorDiv(), cannotMove + ' ' + sourceNode.data.title + ' ' + hasChildrenString);
                            } else {
                                $.ajax({
                                    url: lazyLoadUrlGetChildren + sourceNode.data.key,
                                    type: 'GET',
                                    cache: false,
                                    aysnc: false,
                                    success: function (data) {
                                        var childCount = $.parseJSON(data).length;
                                        if (childCount === 0) {
                                            moveGermplasm(sourceNode, node);
                                        } else {
                                            showErrorMessage(getMessageErrorDiv(), cannotMove + ' ' + sourceNode.data.title + ' ' + hasChildrenString);
                                        }

                                    }
                                });
                            }
                        },
                        onDragLeave: function (node, sourceNode) {
                            /** Always called if onDragEnter was called.
                             */
                        }
                    }
                };

                if (clickFunction) {
                    dynaTreeOptions.onClick = clickFunction;
                }

				$('#' + treeName).dynatree(dynaTreeOptions);
			}
			
			
	//]]>
	</script>
</div>