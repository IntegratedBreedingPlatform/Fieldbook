<section xmlns:th="http://www.thymeleaf.org" th:remove="tag">
    <div ng-cloak="" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="designMapModal" id="designMapModal" aria-hidden="true">
        <div class="modal-dialog modal-lg" style="min-width: 98%">
            <div class="modal-content" ng-controller="designImportCtrl">
                <div class="modal-header">
                    <button type="button" class="close closeTrigger" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" th:text="#{design.import.modal.title}">Import Experimental Design</h4>
                </div>
                <section class="modal-body" style="height:450pt; overflow-y: auto">
                    <div class="row">
                        <div class="col-md-7">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <strong class="sub-content-heading col-md-12" th:text="#{design.import.experimental.type}"></strong>
                                </div>

                                <div class="form-group">
                                    <label for="design-type-select" class="col-md-6 col-sm-8 control-label" th:text="#{design.import.experimental.type.select}"></label>

                                    <div class="col-md-6 col-sm-4">
                                        <select id="design-type-select" ng-model="designType" ng-change="onDesignTypeSelect()">
                                            <option value="">Please Choose</option>
                                            <option value="0">Randomized Complete Block Design</option>
                                            <option value="1">Resolvable Incomplete Block Design</option>
                                            <option value="2">Row-and-Column</option>
                                            <option value="3">Other Design</option>

                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <strong class="sub-content-heading pull-left" th:text="#{design.import.map.column.header}"></strong>
                            <span class="btn btn-link pull-right" th:text="#{ontology.browser.modal.scale.variable}" ng-click="launchOntologyBrowser()"></span>
                        </div>
                    </div>
                    <div class="row">
                        <p class="col-md-12" th:text="#{design.import.map.column.header.desc}"></p>
                    </div>

                    <div class="row">
                        <div class="col-sm-4" >
                            <div class="panel panel-danger">
                                <div class="panel-heading"><b class="panel-title">Un-Mapped <span class="badge-danger counter" style="float:right">{{unmappedHeaders.length}}</span></b>
                                </div>
                                <div class="unmapped list-group" ui-sortable="{ 'connectWith': '.list-group' }" ng-model="data.unmappedHeaders">
                                    <div class="list-group-item" ng-repeat="header in data.unmappedHeaders">
                                        <h4>{{header.name}}</h4>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="col-sm-8">
                            <mapping-group name="Environmental Factors" data="data.mappedEnvironmentalFactors" variable-type="1020"></mapping-group>
                            <mapping-group name="Design Factors" data="data.mappedDesignFactors" variable-type="1030"></mapping-group>
                            <mapping-group name="Germplasm Factors" data="data.mappedGermplasmFactors" variable-type="1040"></mapping-group>
                            <mapping-group name="Traits" data="data.mappedTraits" variable-type="1043"></mapping-group>
                        </div>

                    </div>

                </section>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default closeTrigger" data-dismiss="modal" aria-hidden="true" th:text="#{common.form.cancel.text}">Cancel</button>
                    <button type="button" class="btn btn-primary closeTrigger" th:text="#{common.form.next.text}" ng-click="validateAndSend()">Next</button>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" th:src="@{/static/js/lib/angular/sortable.js}"></script>
    <script type="text/javascript" th:src="@{/static/js/design-import/design-import-main.js}"></script>

    <script th:inline="javascript">
        //<![CDATA[

        (function() {
            angular.module('designImportApp')
                    .constant('VARIABLE_SELECTION_MODAL_SELECTOR', '.vs-modal')
                    .constant('VARIABLE_SELECTION_LABELS',{
                        /*ENVIRONMENTAL FACTORS*/
                        1020: {
                            label: /*[[#{design.import.environmental.factors}]]*/ '',
                            placeholder: /*[[#{design.import.environmental.factors.placeholder}]]*/ ''
                        },
                        /*DESIGN FACTORS*/
                        1030: {
                            label: /*[[#{design.import.design.factors}]]*/ '',
                            placeholder: /*[[#{design.import.design.factors.placeholder}]]*/ ''
                        },
                        /*GERMPLASM FACTORS*/
                        1040: {
                            label: /*[[#{design.import.germplasm.factors}]]*/ '',
                            placeholder: /*[[#{design.import.germplasm.factors.placeholder}]]*/ ''
                        },
                        /*TRAITS*/
                        1043: {
                            label: /*[[#{design.import.traits}]]*/ '',
                            placeholder: /*[[#{design.import.traits.placeholder}]]*/ ''
                        },
                        generalAjaxError : /*[[#{nursery.managesettings.variable.selection.error}]]*/ '',
                        variableSelectedMessage : /*[[#{common.warning.variable.in.use}]]*/ '',
                        invalidAliasError : /*[[#{variable.selection.alias.error}]]*/ ''
                    })
                    /* INTERNATIONALIZED MESSAGES HERE */
                    .constant('Messages',{
                        'REQUIRED' : 'Required',
                        'OWN_DESIGN_SELECT_WARNING' : 'Please note that the analysis results for designs generated outside the BMS may be unreliable, and that analysis in the BMS may not be possible for some design types.'
                    });
        })();

        // ]]>
    </script>

</section>
