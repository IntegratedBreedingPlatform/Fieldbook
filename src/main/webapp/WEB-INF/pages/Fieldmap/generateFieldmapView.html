<div class="col-md-12" xmlns:th="http://www.thymeleaf.org">
	<div class="page-header">
		<h1 th:text="#{fieldmap.header.field.plan}">
			FIELD PLAN
		</h1>
	</div>			  
</div>
<div class="row">
	<div class="col-md-3">
		<h4 th:text="#{fieldmap.header.make.a.field.plan}">Make a Field Plan</h4>
	</div>
	<div class="col-md-3">
		<h4 th:text="#{fieldmap.header.enter.details}">1. ENTER FIELD DETAILS</h4>
	</div>
	<div class="col-md-3">
		<h4 th:text="#{fieldmap.header.enter.planting.details}">2. ENTER PLANTING DETAILS</h4>
	</div>
	<div class="col-md-3">
		<h4 th:text="#{fieldmap.header.generate.field.map}">3. GENERATE FIELD MAP</h4>
	</div>
</div>
<form id="fieldmapForm" name="fieldmapForm" role="form-horizontal" class="form-horizontal" action="#"
th:action="@{/Fieldmap/generateFieldmapView}" method="post" th:object="${fieldmapForm}" enctype="multipart/form-data">

<input type="hidden" id="markedCells" name="markedCells" />
<div class="table-responsive">
	<table id="field-map" class="table" border="1">
	
	<thead>
		<tr>
			<td>Rows</td>
			<td th:each="j : ${#numbers.sequence(1, #object.userFieldmap.numberOfRowsInBlock)}">
				<p th:text="${j}"></p>				
			</td>
		</tr>
		<tr>
			<td></td>
			<td th:colspan="*{userFieldmap.numberOfRowsPerPlot}" th:each="j : ${#numbers.sequence(1, #object.userFieldmap.numberOfRowsInBlock / #object.userFieldmap.numberOfRowsPerPlot)}">
				<p th:text="'Column ' + ${j}"></p>
			</td>
		</tr>
	</thead>
	<tbody>
		<tr th:each="i : ${#numbers.sequence(#object.userFieldmap.numberOfRangesInBlock, 1)}">
			<td><p th:text="'Range ' + ${i}"></p></td>
			<td class="plot" th:id="${i} + '_' + ${j}" th:colspan="*{userFieldmap.numberOfRowsPerPlot}" th:each="j : ${#numbers.sequence(1, #object.userFieldmap.numberOfRowsInBlock / #object.userFieldmap.numberOfRowsPerPlot)}">
				<p th:text="${#object.fieldmapLabels[__${(i-1) * #object.userFieldmap.numberOfRangesInBlock + (j-1)}__]}"></p>
			</td>
		</tr>
		<tr>
			<td>Rows</td>
			<td th:each="j : ${#numbers.sequence(1, #object.userFieldmap.numberOfRowsInBlock)}">
				<p th:text="${j}"></p>				
			</td>
		</tr>
		<tr>
			<td></td>
			<td th:colspan="*{userFieldmap.numberOfRowsPerPlot}" th:each="j : ${#numbers.sequence(1, #object.userFieldmap.numberOfRowsInBlock / #object.userFieldmap.numberOfRowsPerPlot)}">
				<p th:text="'Column ' + ${j}"></p>
			</td>
		</tr>
	</tbody>
	
	</table>
	 <button type="button" onclick="javascript: setAllDeletedBox()" class="btn btn-default">Submit Now test</button>

	<div id="fieldmap-area" th:include="/Fieldmap/fieldmapView">
	</div>

</div>

</form>
<div layout:fragment="page-script">		
	<script type="text/javascript" th:src="@{/static/js/raphael-min.js}"></script>
	<script type='text/javascript' th:inline="javascript">
	//<![CDATA[
	  	function setAllDeletedBox(){
	  		var deletedRect = "";
	  		$('#field-map td.plot.deleted').each(function(){
	  			deletedRect += $(this).attr('id');
  				if(deletedRect != ''){
  					deletedRect += ",";
  				}
	  		})
	  			  			  		
	  		if(deletedRect != ''){
	  			deletedRect = deletedRect.substr(0,deletedRect.length-1);
	  		}
	  		$('#markedCells').val(deletedRect);
	  		console.log(deletedRect);
	  		$("#fieldmapForm").submit();
	  	}
	  	$(document).ready(function() {
	  		$('#field-map td.plot').on('click', function() {
	  			if($(this).hasClass('deleted')){
	  				$(this).removeClass('deleted');
	  				$(this).html('');
	  			}else{
	  				$(this).addClass('deleted');
	  				$(this).html("<label class='alert alert-danger'>X</label>");
	  			}
	  			//console.log($(this).attr('id'));
	  		});
	  		
	  	});
    //]]>
	</script>
</div>